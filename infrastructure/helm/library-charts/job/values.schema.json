{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Job Library Chart Values Schema",
  "required": ["type", "image"],
  "properties": {
    "type": {
      "type": "string",
      "enum": ["job", "cronjob"],
      "description": "Workload type: job or cronjob"
    },
    "image": {
      "type": "object",
      "required": ["repository"],
      "properties": {
        "repository": {
          "type": "string",
          "description": "Container image repository"
        },
        "tag": {
          "type": "string",
          "description": "Container image tag"
        },
        "pullPolicy": {
          "type": "string",
          "enum": ["Always", "IfNotPresent", "Never"],
          "description": "Image pull policy"
        }
      }
    },
    "job": {
      "type": "object",
      "properties": {
        "backoffLimit": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of retries before marking job as failed"
        },
        "activeDeadlineSeconds": {
          "type": "integer",
          "minimum": 1,
          "description": "Maximum duration for job execution"
        },
        "ttlSecondsAfterFinished": {
          "type": "integer",
          "minimum": 0,
          "description": "TTL for finished jobs"
        }
      }
    },
    "cronJob": {
      "type": "object",
      "properties": {
        "schedule": {
          "type": "string",
          "pattern": "^(@(annually|yearly|monthly|weekly|daily|hourly|reboot))|(@every (\\d+(ns|us|Âµs|ms|s|m|h))+)|((((\\d+,)+\\d+|(\\d+([/\\-])\\d+)|\\d+|\\*) ?){5,7})$",
          "description": "Cron schedule expression"
        },
        "concurrencyPolicy": {
          "type": "string",
          "enum": ["Allow", "Forbid", "Replace"],
          "description": "Concurrency policy for cron jobs"
        },
        "successfulJobsHistoryLimit": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of successful jobs to keep"
        },
        "failedJobsHistoryLimit": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of failed jobs to keep"
        },
        "suspend": {
          "type": "boolean",
          "description": "Suspend cron job execution"
        }
      }
    },
    "command": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Container command override"
    },
    "args": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Container arguments"
    },
    "env": {
      "type": "array",
      "description": "Environment variables"
    },
    "resources": {
      "type": "object",
      "properties": {
        "limits": {
          "type": "object",
          "properties": {
            "cpu": { "type": "string" },
            "memory": { "type": "string" }
          }
        },
        "requests": {
          "type": "object",
          "properties": {
            "cpu": { "type": "string" },
            "memory": { "type": "string" }
          }
        }
      }
    },
    "podSecurityContext": {
      "type": "object",
      "properties": {
        "runAsNonRoot": { "type": "boolean" },
        "runAsUser": { "type": "integer", "minimum": 0 },
        "fsGroup": { "type": "integer", "minimum": 0 }
      }
    },
    "securityContext": {
      "type": "object",
      "properties": {
        "allowPrivilegeEscalation": { "type": "boolean" },
        "readOnlyRootFilesystem": { "type": "boolean" },
        "runAsNonRoot": { "type": "boolean" },
        "runAsUser": { "type": "integer", "minimum": 0 }
      }
    },
    "nodeSelector": {
      "type": "object",
      "description": "Node selector labels"
    },
    "tolerations": {
      "type": "array",
      "description": "Pod tolerations"
    }
  }
}
